{% extends 'base_compra.html.twig' %}
{% block content %}
    {{ form_start(form, { 'attr': {'class': 'form-horizontal'} }) }}
    <div class="panel panel-default">
        <div class="panel-heading">Información general</div>
        <div class="panel-body">
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Razon social</label>
                <div class="col-sm-10">
                    {{ form_widget(form.razonSocial,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.razonSocial) }}</div>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Tipo Identificacion</label>
                <div class="col-sm-4">
                    {{ form_widget(form.identificacionRel,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.identificacionRel) }}</div>
                </div>
                <label class="col-sm-2 control-label">Nit</label>
                <div class="col-sm-3">
                    {{ form_widget(form.numeroIdentificacion, { 'attr': {'class' : 'form-control','onblur': 'javascript:calcularDigitoVerificacion(this.value)'} }) }}
                    <div style="color:red;">{{ form_errors(form.numeroIdentificacion) }}</div>
                </div>
                <div class="col-sm-1">
                    {{ form_widget(form.digitoVerificacion, {'attr' : {'class' : 'form-control' , 'readonly' : 'readonly'}}) }}
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Primer Nombre</label>
                <div class="col-sm-4">
                    {{ form_widget(form.nombre1,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.nombre1) }}</div>
                </div>
                <label class="col-sm-2 control-label">Segundo Nombre</label>
                <div class="col-sm-4">
                    {{ form_widget(form.nombre2, { 'attr': {'class' : 'form-control'} }) }}
                    <div style="color:red;">{{ form_errors(form.nombre2) }}</div>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Primero Apellido</label>
                <div class="col-sm-4">
                    {{ form_widget(form.apellido1,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.apellido1) }}</div>
                </div>
                <label class="col-sm-2 control-label">Segundo Apellido</label>
                <div class="col-sm-4">
                    {{ form_widget(form.apellido2, { 'attr': {'class' : 'form-control'} }) }}
                    <div style="color:red;">{{ form_errors(form.apellido2) }}</div>
                </div>
            </div>

            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Telefono</label>
                <div class="col-sm-4">
                    {{ form_widget(form.telefono,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.apellido1) }}</div>
                </div>
                <label class="col-sm-2 control-label">Celular</label>
                <div class="col-sm-4">
                    {{ form_widget(form.celular, { 'attr': {'class' : 'form-control'} }) }}
                    <div style="color:red;">{{ form_errors(form.celular) }}</div>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Fax</label>
                <div class="col-sm-4">
                    {{ form_widget(form.fax,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.fax) }}</div>
                </div>
                <label class="col-sm-2 control-label">Email</label>
                <div class="col-sm-4">
                    {{ form_widget(form.email, { 'attr': {'class' : 'form-control'} }) }}
                    <div style="color:red;">{{ form_errors(form.email) }}</div>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-sm-2 control-label">Direccion</label>
                <div class="col-sm-4">
                    {{ form_widget(form.direccion,{ 'attr' : {'class' : 'form-control'}}) }}
                    <div style="color:red;">{{ form_errors(form.direccion) }}</div>
                </div>
                <label class="col-sm-2 control-label">Ciudad</label>
                <div class="col-sm-4">
                    {{ form_widget(form.ciudadRel, { 'attr': {'class' : 'form-control'} }) }}
                    <div style="color:red;">{{ form_errors(form.ciudadRel) }}</div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <a class="btn btn-default btn-sm"
           href="{{ path('compra_administracion_proveedor_proveedor_lista') }}">Cancelar</a>
        {{ form_widget(form.guardar, { 'attr': {'class': 'btn btn-primary btn-sm'} }) }}
    </div>
    {{ form_end(form) }}

    {% block javascripts %}
        <script>
            var digitoVerificacion = null;

            function calcularDigitoVerificacion(myNit) {

                var vpri,
                    x,
                    y,
                    z;

                // Se limpia el Nit
                myNit = myNit.replace(/\s/g, ""); // Espacios
                myNit = myNit.replace(/,/g, ""); // Comas
                myNit = myNit.replace(/\./g, ""); // Puntos
                myNit = myNit.replace(/-/g, ""); // Guiones

                // Se valida el nit
                if (isNaN(myNit)) {
                    console.log("El nit/cédula '" + myNit + "' no es válido(a).");
                    return "";
                }
                ;

                // Procedimiento
                vpri = new Array(16);
                z = myNit.length;

                vpri[1] = 3;
                vpri[2] = 7;
                vpri[3] = 13;
                vpri[4] = 17;
                vpri[5] = 19;
                vpri[6] = 23;
                vpri[7] = 29;
                vpri[8] = 37;
                vpri[9] = 41;
                vpri[10] = 43;
                vpri[11] = 47;
                vpri[12] = 53;
                vpri[13] = 59;
                vpri[14] = 67;
                vpri[15] = 71;

                x = 0;
                y = 0;
                for (var i = 0; i < z; i++) {
                    y = (myNit.substr(i, 1));
                    // console.log ( y + "x" + vpri[z-i] + ":" ) ;

                    x += (y * vpri [z - i]);
                    // console.log ( x ) ;
                }

                y = x % 11;
                // console.log ( y ) ;

                digitoVerificacion = (y > 1) ? 11 - y : y;
                // campoDigitoVerificacion = $('#form_digitoVerificacion');
                document.getElementById("proveedor_digitoVerificacion").value = digitoVerificacion;
                console.log(document.getElementById("proveedor_digitoVerificacion").value)

            }
        </script>

    {% endblock %}
{% endblock %}
